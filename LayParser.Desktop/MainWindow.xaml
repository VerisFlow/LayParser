<Window x:Class="VerisFlow.VenusDeckParser.Desktop.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:core="clr-namespace:VerisFlow.VenusDeckParser.Core;assembly=LayParser.Core"
        Title="LayParser - Deck Layout Reporter"
        Height="600" Width="900"
        MinHeight="450" MinWidth="700"
        WindowStartupLocation="CenterScreen"
        Background="Transparent"
        AllowsTransparency="True"
        WindowStyle="None">
    <Window.Resources>
        <Style TargetType="Button" x:Key="PrimaryButton">
            <Setter Property="Background" Value="#0078D7"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#005A9E"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Background" Value="#A0A0A0"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="Button" x:Key="TitleBarButton">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#555555"/>
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E0E0E0"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="Button" x:Key="CloseButton" BasedOn="{StaticResource TitleBarButton}">
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E81123"/>
                    <Setter Property="Foreground" Value="White"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="TitleBarMenuItemStyle" TargetType="MenuItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="#555555"/>
            <Setter Property="Padding" Value="10,5"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E0E0E0"/>
                </Trigger>
            </Style.Triggers>
        </Style>

    </Window.Resources>

    <Border BorderBrush="#CCCCCC" BorderThickness="1" Background="#F0F2F5" CornerRadius="4">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Grid Grid.Row="0" Height="40" Background="Transparent" MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="10,0,0,0">
                    <Viewbox Width="20" Height="20" VerticalAlignment="Center">
                        <Canvas Width="24" Height="24">
                            <Path Data="M4 12L4 4L12 4L12 12L4 12Z" Stroke="#0078D7" StrokeThickness="2" />
                            <Path Data="M12 20L12 12L20 12L20 20L12 20Z" Stroke="#0078D7" StrokeThickness="2" />
                            <Path Data="M4 20L4 12" Stroke="#0078D7" StrokeThickness="2" />
                            <Path Data="M20 4L12 4" Stroke="#0078D7" StrokeThickness="2" />
                        </Canvas>
                    </Viewbox>
                    <TextBlock Text="LayParser" VerticalAlignment="Center" Margin="10,0,0,0" Foreground="#1C1C1C"/>
                </StackPanel>

                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Menu Background="Transparent">
                        <MenuItem Header="_Help" Style="{StaticResource TitleBarMenuItemStyle}">
                            <MenuItem Header="_About" Click="AboutMenuItem_Click" />
                        </MenuItem>
                    </Menu>
                    <Button Style="{StaticResource TitleBarButton}" Content="—" Click="Minimize_Click"/>
                    <Button Style="{StaticResource TitleBarButton}" Content="☐" Click="Maximize_Restore_Click"/>
                    <Button Style="{StaticResource CloseButton}" Content="✕" Click="Close_Click"/>
                </StackPanel>
            </Grid>

            <Grid Grid.Row="1" AllowDrop="True" DragEnter="MainContent_DragEnter" DragLeave="MainContent_DragLeave" Drop="MainContent_Drop">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Border Grid.Row="0" Background="White" Padding="20" BorderBrush="#DDDDDD" BorderThickness="0,1,0,1">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <TextBlock Text="Deck Layout Reporter" FontSize="22" FontWeight="SemiBold" Foreground="#1C1C1C"/>
                            <TextBlock Text="Select a deck layout file (.lay) to view the processed labware information."
                                       Foreground="#555555" TextWrapping="Wrap" Margin="0,5,0,0"/>
                        </StackPanel>

                        <Button Grid.Column="1" Style="{StaticResource PrimaryButton}"
                                x:Name="SelectLayoutButton"
                                Width="200" Height="40" VerticalAlignment="Center"
                                Click="SelectDeckLayout_Click">
                            <StackPanel Orientation="Horizontal">
                                <Path Width="16" Height="16" Fill="White" Margin="0,0,10,0"
                                      Data="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z" />
                                <TextBlock Text="Select Deck Layout File" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </Grid>
                </Border>

                <Grid Grid.Row="1">
                    <DataGrid x:Name="LabwareDataGrid" Margin="10"
                              ItemsSource="{Binding ProcessedLabwareData}"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              GridLinesVisibility="Horizontal"
                              HorizontalScrollBarVisibility="Auto"
                              VerticalScrollBarVisibility="Auto"
                              Background="White"
                              BorderBrush="#CCCCCC"
                              HeadersVisibility="Column">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="#" Binding="{Binding Index}" Width="40"/>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="4*"/>
                            <DataGridTextColumn Header="Type" Binding="{Binding LabwareType}" Width="80"/>
                            <DataGridTextColumn Header="Template" Binding="{Binding Template}" Width="4*"/>
                            <DataGridTextColumn Header="X" Binding="{Binding FinalX}" Width="*"/>
                            <DataGridTextColumn Header="Y" Binding="{Binding FinalY}" Width="*"/>
                            <DataGridTextColumn Header="Width" Binding="{Binding Dx}" Width="*"/>
                            <DataGridTextColumn Header="Length" Binding="{Binding Dy}" Width="*"/>
                            <DataGridTextColumn Header="Column" Binding="{Binding Column}" Width="*"/>
                            <DataGridTextColumn Header="Row" Binding="{Binding Row}" Width="*"/>
                            <DataGridTextColumn Header="TipRack" Binding="{Binding TipRack}" Width="*"/>
                            <DataGridTextColumn Header="AlphaIndex" Binding="{Binding AlphaIndex}" Width="*"/>
                        </DataGrid.Columns>
                    </DataGrid>

                    <TextBlock FontSize="16"
                               Foreground="Gray"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Text" Value="Select a file or drag it here to begin."/>
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Items.Count, ElementName=LabwareDataGrid}" Value="0">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Grid>

                <Border x:Name="DragDropOverlay"
                        Background="#88FFFFFF"
                        BorderBrush="#0078D7"
                        BorderThickness="2"
                        CornerRadius="4"
                        Margin="10"
                        Grid.RowSpan="2"
                        Visibility="Collapsed">
                    <TextBlock Text="Drop the .lay file here"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"
                               FontSize="22"
                               FontWeight="Bold"
                               Foreground="#0078D7"/>
                </Border>

                <Border Grid.Row="2" Background="#0078D7" Padding="10">
                    <TextBlock x:Name="StatusTextBlock"
                               Text="Ready. Please select a deck layout file."
                               Foreground="White"
                               VerticalAlignment="Center"/>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>